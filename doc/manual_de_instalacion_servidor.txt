DIARIO DE INSTALACIÓN DEL SERVIDOR DE PRODUCCIÓN DE CIDESAL 
diaspora.limsi.fr

usuario : cidesal
pwd : --------

1) Instalación de Mandriva 2010.2 x86_64
2) Instalación de subversion 1.6.17 con rpmdrake
3) Descarga de tami/cidesal/code
sudo svn co svn+ssh://jgflores@tami/home/svn/cidesal/code/
4) Instalación de NLTK
1. Instalación de python-yaml v3.09 (rpmdrake)
2. Instalación de lib64python2.6-devel v2.6.5 (rpmdrake)
5) Instalación de python-magic (urpmi python-magic)
6) Instalación de Freeling (manual aquí http://nlp.lsi.upc.edu/freeling/doc/userman/html/node12.html )
1. Instalación de las herramientas de compilación y desarrollo C++
urpmi task-c++-devel
2. Instalación de python-dev 
3.  Instalación de lib64pcre-devel (rpmdrake)
4. Instalación de lib64db-4.7devel (rpmdrake)
5. Instalación de lib64boost-devel (rpmdrake)
6. Instalación libfries (compilación a partir de código fuente)
7. Instalación libomlet (compilación a partir de código fuente)
8. Instalación Freeling (compilación a partir de código fuente)
1. Error 
boost/property_map.hpp : Aucun fichier ou dossier de ce type
sustituir boost/property_map.hpp por boost/property_map/property_map.hpp 
en los siguientes archivos :
 ./src/libmorfo/disambiguator/ukb/common.h
disambiguator/ukb/kbGraph.h
9. Configuración de la interfaz Freeling/python
1. Instalar swig (rpmdrake)
2. Editar el archivo
cidesal/code/unoporuno/module/unoporuno/Freeling-python-API/Makefile
con las siguientes variables : 

FREELINGDIR = /usr/share
LIBSDIR = /usr/lib
PYTHONDIR = /usr/include/python2.6

3.  Compilar con make (desde el directorio cidesal/code/unoporuno/module/unoporuno/Freeling-python-API/Makefile )
4. Agregar la siguiente línea al archivo ~/.bashrc
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:'/usr/local/lib'
5. Copiar los siguientes archivos desde 
cidesal/code/unoporuno/module/unoporuno/Freeling-python-API/libmorfo_python.py
cidesal/code/unoporuno/module/unoporuno/Freeling-python-API/_libmorfo_python.so
a
cidesal/code/unoporuno/module/unoporuno/
7) Instalación de bibliotecas necesarias a buscador.py
1. Instalar python-setuptools (rpmdrake)
2. Instalar yql
sudo easy_install yql
En caso de error en los permisos, verificar que los archivos de 
 /usr/lib/python2.6/site-packages/
tienen permiso de lectura para todo el mundo. Si no, 
sudo chmod a+r /usr/lib/python2.6/site-packages/easy-install.pth
3. Instalar lxml (rpmdrake... de otro modo es muy difícil, especialmente con easy_install)

8) Probar búsqueda en google
1. Ir al directorio /home/cidesal/code/unoporuno/test
mkdir results
python ../module/search_geo.py corpus.1.argentinos.csv results/
2. En el directorio results debe haber un archivo xml válido llamado Mabel_Cruz.1.xml con los resultados de la búsqueda google (vínculos internet válidos)
3. Probar converging_results
python ../module/converging_pipelines.py corpus.3.argentinos.csv results
4. En el directorio results debe haber cuatro subdirectorios llamados 
results_converging/
results_name
results_geo
results_orgs
results_topics
En cada uno de ellos debe haber 3 archivos xml válidos con resultados de la búsqueda google.
 
9) Instalación de Apache (rpmdrake)
10) Instalación de Django v1.3
1. Problemas con mysql 
1. ERROR 1045 (28000): Access denied for user ‘root’@'localhost’ (using password: NO) 
1. se resuelve corriendo mysql_db_install y luego, bajo my_sql_safe, este SQL 
2. INSERT INTO user VALUES ('localhost','root',password('the_password'), 'Y', 'Y', 'Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','','','','',0,0,0,0);
2. Mysql Connexion denied error
1. Problema de permisos en /var/lib/mysql
1. Se resuelve con 
sudo chown mysql.mysql /var/lib/mysql
y agregar al usuario cidesal al grupo mysql en /etc/groups 
2. Instalación ahora sí de Django
https://www.djangoproject.com/download/
https://docs.djangoproject.com/en/1.3/intro/install/
3. Instalación del servidor de tareas Celery
1. cambiar la configuración de settings.py y django.wsgi
2. crear las tablas con un python manage.py syncdb
3. copiar unoporuno.conf a ~/ROOT/webapp/cidesal	
11) Instalación de la aplicación unoporuno.web
1. svn TODO : comando svn para importar una aplicacion open source
2. Crear la base de datos en el directorio $UNOPORUNO_ROOT (normalmente /home/mydirectory/unoporuno/webapps )
cd $UNOPORUNO_ROOT/cidesal
python manage syncdb
3. Establecer la variable DJANGO_SETTINGS_MODULE en ~/.bashrc agregando la línea
export DJANGO_SETTINGS_MODULE='cidesal.settings'
12) Poblar la base de datos  (todo db_populate o como?... TODO : poner una búsqueda de test)
13) Instalación de apache-mod_wsgi (rpmdrake)
http://code.google.com/p/modwsgi/wiki/QuickInstallationGuide
14) Configuración de Apache + wsgi

      15) Instalar Celery server <<Falta configuración del servidor CELERY>>

      16) Configuar celery en daemon
	--crear usuario celery
	--crear fichero de configuracion /etc/default/celeryd
	– bajar fichero model desde 
		http://github.com/celery/celery/tree/master/contrib/generic-init.d/
	   y ponerlo en /etc/initd/celeryd
	--crear el directorio /var/log/celery y atribuirle los permisos con 
		sudo chown celery.root /var/log/celery 
	--crear el directorio /var/run/celery y atribuirle los permisos con
		sudo chown celery.root /var/run/celery

	
